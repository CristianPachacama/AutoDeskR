<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>AutoDeskR by paulgovan</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>AutoDeskR</h1>
        <h2>An R Interface to the AutoDesk APIs</h2>
        <a href="https://github.com/paulgovan/AutoDeskR" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="the-autodeskr-package" class="anchor" href="#the-autodeskr-package" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The AutoDeskR Package:</h1>

<p>AutoDeskR is an R package that provides an interface to the:</p>

<ul>
<li>Authentication API for obtaining authentication to the AutoDesk Forge Platfrom.</li>
<li>Data Management API for managing data across the platform's cloud services. </li>
<li>Design Automation API for performing automated tasks on design files in the cloud.</li>
<li>Model Derivative API for translating design files into different formats, sending them to the viewer app, and extracting design data.</li>
</ul>

<p>For more information about the AutoDesk Forge Platform, please visit <a href="https://developer.autodesk.com">https://developer.autodesk.com</a></p>

<h1>
<a id="quick-start" class="anchor" href="#quick-start" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Quick Start</h1>

<p>To install AutoDeskR in <a href="https://www.r-project.org">R</a>:</p>

<pre><code>devtools::install_github('paulgovan/autodeskr')
</code></pre>

<h1>
<a id="authentication" class="anchor" href="#authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authentication</h1>

<p>AutoDesk uses OAuth-based authentication for access to their services. To get started with this package, first visit the <a href="https://developer.autodesk.com/en/docs/oauth/v2/tutorials/create-app/">Create an App</a> tutorial for instructions on creating an app and getting a Client ID and Secret. </p>

<p>We highly recommend that the Client ID, Secret, access tokens, and so on be stored in a file called <code>.Renviron</code> and accessing these keys with the <code>Sys.getenv()</code> function. This way potentially sensitive information is never explicitly passed to functions in this package. For more information on storing keys in the <code>.Renviron</code> file and accessing them with <code>Sys.getenv()</code>, see the appendix in this <a href="https://cran.r-project.org/web/packages/httr/vignettes/api-packages.html">API Best Practices</a> vignette.  </p>

<p>To get an access token, use the <code>getToken()</code> function, which returns an object with the <code>access_token</code>, <code>type</code>, and <code>expires_in</code> variables.:</p>

<pre><code>getToken(id = Sys.getenv("client_id"), secret = Sys.getenv("client_secret"))
</code></pre>

<h1>
<a id="data-management" class="anchor" href="#data-management" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Data Management</h1>

<h2>
<a id="create-a-bucket-and-upload-a-file" class="anchor" href="#create-a-bucket-and-upload-a-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create a Bucket and Upload a File</h2>

<p>Design files are hosted in the cloud and organized into buckets. To create a bucket, first get a token with the <code>bucket:create</code>, <code>bucket:read</code>, and <code>data:write</code> scopes. </p>

<pre><code>getToken(id = Sys.getenv("client_id"), secret = Sys.getenv("client_secret"), 
    scope = "bucket:create bucket:read data:write")
</code></pre>

<p>Then use the <code>makeBucket()</code> function to create a bucket, where "access_token" is generated with the <code>getToken()</code> function and <code>bucket</code> is a name for the bucket. </p>

<pre><code>makeBucket(token = Sys.getenv("access_token"), bucket = "mybucket")
</code></pre>

<p>To check the status of a bucket:</p>

<pre><code>checkBucket(token = Sys.getenv("access_token"), bucket = "mybucket")
</code></pre>

<p>Finally, to upload a file to the bucket, use the <code>uploadFile()</code> function, which returns an object containing the <code>bucketKey</code>, <code>objectId</code> (i.e. urn), <code>objectKey</code> (i.e. file name), <code>size</code>, <code>contentType</code> (i.e. "application/octet-stream"), <code>location</code> and other content information. Note the unique urn of the file and store it in <code>.Renviron</code> for future use. </p>

<pre><code>uploadFile(file = system.file("inst/samples/aerial.dwg", package = "AutoDeskR"),
    token = Sys.getenv("access_token"), bucket = "mybucket")
</code></pre>

<h1>
<a id="design-automation" class="anchor" href="#design-automation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Design Automation</h1>

<h2>
<a id="convert-a-dwg-file-to-a-pdf-file" class="anchor" href="#convert-a-dwg-file-to-a-pdf-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Convert a DWG File to a PDF File</h2>

<p>To convert a DWG file to a PDF file, use the <code>makePdf</code> function, where <code>source</code> and <code>destination</code> are the publicly accessible source of the DWG file and destination for the PDF file, respectively. </p>

<pre><code>mySource &lt;- "http://download.autodesk.com/us/samplefiles/acad/visualization_-_aerial.dwg"
myDestination &lt;- "https://drive.google.com/folderview?id=0BygncDVHf60mTDZVNDltLThLNmM&amp;usp=sharing"
makePdf(mySource, myDestination, token = Sys.getenv("access_token"))
</code></pre>

<p>Note that in this example, the "access_token" must be generated with the <code>code:all</code> scope.</p>

<p>To check the status of the conversion process:</p>

<pre><code>checkPdf(mySource, myDestination, token = Sys.getenv("access_token"))
</code></pre>

<h1>
<a id="model-derivative" class="anchor" href="#model-derivative" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Model Derivative</h1>

<h2>
<a id="translate-a-file-into-obj-format" class="anchor" href="#translate-a-file-into-obj-format" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Translate a File into OBJ Format</h2>

<p>To translate a file into OBJ format, first get an access token with the <code>data:read</code> and <code>data:write</code> scopes.</p>

<pre><code>getToken(id = Sys.getenv("client_id"), secret = Sys.getenv("client_secret"), 
    scope = "data:read data:write")
</code></pre>

<p>AutoDesk requires that the urn of the file be Base-64 encoded. Fortunately, the <code>jsonlite</code> package has a nifty function for encoding the urn. </p>

<pre><code>myURN &lt;- jsonlite::base64_enc(Sys.getenv("urn"))
</code></pre>

<p>Then, translate the file into OBJ format:</p>

<pre><code>translateSvf(urn &lt;- myUrn, token = Sys.getenv("access_token"))
</code></pre>

<p>To check the status of the translation process:</p>

<pre><code>checkFile(urn &lt;- myUrn, token = Sys.getenv("access_token"))
</code></pre>

<p>To get the output_urn of the translated file, use the <code>getOutputUrn()</code> function, which returns an object containing the <code>result</code>, output <code>urn</code> and other activity information.</p>

<pre><code>getOutputUrn(urn &lt;- myUrn, token = Sys.getenv("token"))
</code></pre>

<p>To download the OBJ file locally:</p>

<pre><code>myOutputUrn &lt;- jsonlite::base64_enc(Sys.getenv("output_urn"))
downloadFile(urn &lt;- myUrn, output_urn &lt;- myOutputUrn, token = Sys.getenv("token"))
</code></pre>

<h2>
<a id="prepare-a-file-for-the-viewer" class="anchor" href="#prepare-a-file-for-the-viewer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prepare a File for the Viewer</h2>

<p>To prepare a file for the viewer, first get an access token with the <code>data:read</code> and <code>data:write</code> scopes.</p>

<pre><code>getToken(id = Sys.getenv("client_id"), secret = Sys.getenv("client_secret"), 
    scope = "data:read data:write")
</code></pre>

<p>Encode the urn using the <code>jsonlite::base64_enc</code> function. </p>

<pre><code>myURN &lt;- jsonlite::base64_enc(Sys.getenv("urn"))
</code></pre>

<p>Then, translate the file into SVF format:</p>

<pre><code>translateSvf(urn &lt;- myUrn, token = Sys.getenv("access_token"))
</code></pre>

<p>To check the status of the translation process:</p>

<pre><code>checkFile(urn &lt;- myUrn, token = Sys.getenv("access_token"))
</code></pre>

<p>Finally, embed the urn of the file in the viewer, which will be described in a future tutorial.</p>

<h2>
<a id="extract-data-from-a-file" class="anchor" href="#extract-data-from-a-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Extract Data from a File</h2>

<p>To extract data from a file, first get a token with the <code>data:read</code> and <code>data:write</code> scopes, encode the urn of the file using the <code>jsonlite::base64_enc()</code> function, and translate the file into the SVF format using the <code>translateSvf</code> function.  Next, retrieve the metadata for a file using the <code>getMetadata()</code> function, which returns an object with the <code>type</code>, <code>name</code>, and <code>guid</code> of the file. Note the <code>guid</code> and store it in <code>.Renviron</code>.</p>

<pre><code>getMetadata(urn &lt;- myUrn, token = Sys.getenv("access_token"))
</code></pre>

<p>Then get the properties of the file with the <code>getData()</code> function.</p>

<pre><code>getData(guid &lt;- Sys.getenv("guid"), urn &lt;- myUrn, token = Sys.getenv("access_token"))
</code></pre>

<h2>
<a id="extract-geometry-from-a-file" class="anchor" href="#extract-geometry-from-a-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Extract Geometry from a File</h2>

<p>To get the object tree of a file, follow the previous instructions for extracting data from a file, and note the "guid", "urn", and "access_token". Then use the <code>getObjectTree()</code> function.</p>

<pre><code>getObjectTree(guid &lt;- Sys.getenv("guid"), urn &lt;- myUrn, token = Sys.getenv("token"))
</code></pre>

<h1>
<a id="issues" class="anchor" href="#issues" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Issues</h1>

<p>This project is in its <em>very</em> early stages. Please let us know if there are any issues using the GitHub issue tracker at <a href="https://github.com/paulgovan/AutoDeskR/issues">https://github.com/paulgovan/AutoDeskR/issues</a></p>

<h1>
<a id="contributions" class="anchor" href="#contributions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contributions</h1>

<p>Contributions are welcome by sending a <a href="https://github.com/paulgovan/AutoDeskR/pulls">pull request</a></p>

<h1>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h1>

<p>AutoDeskR is licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache</a> licence. © Paul Govan (2016)</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/paulgovan/AutoDeskR/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/paulgovan/AutoDeskR/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/paulgovan/AutoDeskR"></a> is maintained by <a href="https://github.com/paulgovan">paulgovan</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
